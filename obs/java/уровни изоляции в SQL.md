Уровень изоляции (или изолированности) определяет, как транзакции могут взаимодействовать вежду собой, и насколько сильно могут пересекаться, и мешать друг другу при параллельной работе. Иначе говоря, разные уровни изоляции допускают или не допускают
разные аномалии при параллельной работе транзакций.
**Основные 4 уровня изоляции:**
- READ UNCOMITTED -видит результат не закоммитченых данных других транзакций (dirty read).
- READ COMITTED - чтение только закоммитченых данных.
- REPEATABLE READ - пока транзакция не завершена строки никто не может перезаписать.
- SERIALIZABLE
  

Аномалии
1. dirty read
2. non-reapeatable read
3. phantom read
4. Потерянное обновление (Lost Update) - когда две транзакции одновременно читают и изменяют одни и те же данные, и при этом одно из изменений может потеряться.
5. Неупорядоченное чтение (0ut-of-order — когда несколько чтений выполняются в произвольном порядке, что может привести к неправильным результатам в транзакциях.

![[isolation_level.png]]


Специфичные для Db2 
READ STABILITY и CURSOR STABILITY уровни предлагают уже более тонкую настройку изоляции :

CURSOR ST6BILITY (CS) блокирует текущую строку, прочитанную через некий курсор (курсор мы специально ставим в запросе, и он будет, например, ходить по каждой строке нашего запроса по порядку). С уровнем CURSOR STABILITY мы блокируем только ту строку, на которой сейчас находится курсор . 
READ STABILITY (RS) обеспечивает ситуацию, когда данные, прочитанные одной транзакцией, не будут изменены другой транзакцией до завершения первой транзакции. Т. е. тут нет проблемы неповторяющегося чтения, но могут быть фантомные чтения.

В SQL Server есть SNAPSHOT ISOLATION (многоверсионная изоляция), которая позволяет транзакциям видеть снимок базы
данных на момент начала транзакциии, устраняя тем самым фантомное чтение и неповторяющееся чтение и не блокирует данные при их чтении, что обеспечивает параллелизм (одновременное чтение одних и тех же данных разными транзакциями) — тоже за счёт MVCC.

позволяет каждой транзакции работать с её собственной версией базы (грубо говоря), не влияя на остальные транзакции и не блокируя данные (но надо учитывать, что в зависимости от СУБД принцип работы MVCC может меняться) .

![[set_isolation_level_sql.png]]